<div class="page page-places"> <div class="pageheader"> <h2><i class="fa fa-map-marker"></i> {{page.title}}</h2> <div class="page-bar"> <ul class="page-breadcrumb"> <li> <a ui-sref="app.dashboard"><i class="fa fa-home"></i> {{main.title}}</a> </li> <li> <a ui-sref="app.geofences">{{page.title}}</a> </li> </ul> </div> </div> <!-- row --> <div class="row"> <div class="col-md-12"> <!-- tile --> <section class="tile bg-dummy" fullscreen="isFullscreen01" ng-class="{'loading': loading}"> <!-- tile header --> <div class="tile-header dvd dvd-btm"> <h1 class="custom-font"><strong>Manage </strong>Geofences</h1> <ul class="controls"> <li><a href="javascript:;" ng-click="openModal()"><i class="fa fa-plus mr-5"></i> Add Geofences</a></li> <li class="dropdown" uib-dropdown on-toggle="toggled(open)"> <a href uib-dropdown-toggle class="dropdown-toggle snippets"><i class="fa fa-ellipsis-v"></i></a> <ul class="dropdown-menu pull-right with-arrow animated littleFadeInUp"> <li> <a href ng-click="getSnippet('places')"> <i class="fa fa-terminal"></i> Get CURL snippet </a> </li> </ul> </li> <li class="dropdown" uib-dropdown on-toggle="toggled(open)"> <a href uib-dropdown-toggle class="dropdown-toggle settings"><i class="fa fa-cog"></i></a> <ul class="dropdown-menu pull-right with-arrow animated littleFadeInUp"> <li> <a href tile-control-toggle> <span class="minimize"><i class="fa fa-angle-down"></i>&nbsp;&nbsp;&nbsp;Minimize</span> <span class="expand"><i class="fa fa-angle-up"></i>&nbsp;&nbsp;&nbsp;Expand</span> </a> </li> <li> <a href tile-control-refresh ng-click="ajaxFaker()"> <i class="fa fa-refresh"></i> Refresh </a> </li> <li> <a href tile-control-fullscreen ng-click="isFullscreen01 = !isFullscreen01"> <i class="fa fa-expand"></i> Fullscreen </a> </li> </ul> </li> <li class="remove"><a href tile-control-close><i class="fa fa-times"></i></a></li> </ul> </div> <!-- /tile header --> <!-- tile body --> <div class="tile-body"> <div class="table-responsive"> <input type="text" class="form-control underline-input w-md pull-right mb-20" placeholder="Search..." ng-model="tableOpts.q" ng-model-options="{ debounce: 1000 }" ng-change="search()"> <table class="table table-custom ng-table"> <thead> <tr> <th> <div></div>  <th ng-click="sortBy('name')" class="sortable" ng-class="{'sort-asc': tableOpts.dir === 'asc' && tableOpts.order === 'name', 'sort-desc': tableOpts.dir === 'desc' && tableOpts.order === 'name'}"> <div>Name <span class="sort-indicator"></span></div>  <th ng-click="sortBy('address')" class="sortable" ng-class="{'sort-asc': tableOpts.dir === 'asc' && tableOpts.order === 'address', 'sort-desc': tableOpts.dir === 'desc' && tableOpts.order === 'address'}"> <div>Address <span class="sort-indicator"></span></div>  <th ng-click="sortBy('area.lat')" class="sortable" ng-class="{'sort-asc': tableOpts.dir === 'asc' && tableOpts.order === 'area.lat', 'sort-desc': tableOpts.dir === 'desc' && tableOpts.order === 'area.lat'}"> <div>Latitude <span class="sort-indicator"></span></div>  <th ng-click="sortBy('area.lng')" class="sortable" ng-class="{'sort-asc': tableOpts.dir === 'asc' && tableOpts.order === 'area.lng', 'sort-desc': tableOpts.dir === 'desc' && tableOpts.order === 'area.lng'}"> <div>Longitude <span class="sort-indicator"></span></div>  <th> <div>Actions</div>    <tbody> <tr ng-repeat="geofence in geofences"> <td> <a href="javascript:;" ng-click="getGeofenceLocation(geofence)" uib-tooltip="Show on map"><i class="fa fa-location-arrow"></i></a>  <td> <a href="javascript:;" ng-click="show(geofence)">{{geofence.name}}</a>  <td> {{geofence.address}}  <td> {{geofence.area.lat}}  <td> {{geofence.area.lng}}  <td data-title="'Actions'" class="actions"> <a href="javascript:;" class="edit" ng-click="openModal(geofence)">Edit</a> <a href="javascript:;" class="delete" ng-click="delete(geofence)">Delete</a>    </table> <nav class="pull-right"> <uib-pagination total-items="tableOpts.total" max-size="5" force-ellipses="true" items-per-page="tableOpts.limit" boundary-links="true" ng-model="tableOpts.currentPage" ng-change="pageChanged()" class="pagination-xs pagination-custom"></uib-pagination> </nav> <select class="form-control inline-block" style="width: auto; margin: 20px 0 5px" ng-model="tableOpts.limit" ng-change="setLimit()" convert-to-number> <option value="10">10 <option value="25">25 <option value="50">50 <option value="100">100 </select> </div> </div> <!-- /tile body --> </section> <!-- /tile --> </div> <div class="col-md-12"> <!-- tile --> <section class="tile bg-dummy" fullscreen="isFullscreen02"> <!-- tile header --> <div class="tile-header dvd dvd-btm dvd-white"> <h1 class="custom-font"><strong>Overview </strong>Map</h1> <ul class="controls"> <li class="dropdown" uib-dropdown on-toggle="toggled(open)"> <a href uib-dropdown-toggle class="dropdown-toggle snippets"><i class="fa fa-ellipsis-v"></i></a> <ul class="dropdown-menu pull-right with-arrow animated littleFadeInUp"> <li> <a href ng-click="getSnippet('inputs')"> <i class="fa fa-terminal"></i> Get CURL snippet </a> </li> </ul> </li> <li class="dropdown" uib-dropdown on-toggle="toggled(open)"> <a href uib-dropdown-toggle class="dropdown-toggle settings"><i class="fa fa-cog"></i></a> <ul class="dropdown-menu pull-right with-arrow animated littleFadeInUp"> <li> <a href tile-control-toggle> <span class="minimize"><i class="fa fa-angle-down"></i>&nbsp;&nbsp;&nbsp;Minimize</span> <span class="expand"><i class="fa fa-angle-up"></i>&nbsp;&nbsp;&nbsp;Expand</span> </a> </li> <li> <a href tile-control-refresh ng-click="ajaxFaker()"> <i class="fa fa-refresh"></i> Refresh </a> </li> <li> <a href tile-control-fullscreen ng-click="isFullscreen02 = !isFullscreen02"> <i class="fa fa-expand"></i> Fullscreen </a> </li> </ul> </li> <li class="remove"><a href tile-control-close><i class="fa fa-times"></i></a></li> </ul> </div> <!-- /tile header --> <!-- tile body --> <div class="tile-body"> <leaflet center="center" defaults="defaults" layers="layers" markers="markers" paths="paths" height="600px" id="geofencesMap"></leaflet> </div> <!-- /tile body --> </section> <!-- /tile --> </div> </div> <!-- /row --> </div> <script type="text/ng-template" id="geofenceControlModal.html"><div class="modal-header">
    <h3 class="modal-title custom-font" ng-hide="editing"><i class="fa fa-circle-o mr-5"></i> Add Geofence</h3>
    <h3 class="modal-title custom-font" ng-show="editing"><i class="fa fa-circle-o mr-5"></i> Edit Geofence</h3>
  </div>
  <div class="modal-body p-0">



    <form name="addForm" class="form-horizontal form-validation" role="form" novalidate>

      <uib-tabset class="tab-container tab-wizard" justified="true" active="active">

        <uib-tab index="0">

          <uib-tab-heading>
            Basic Info
            <span class="badge badge-default pull-right wizard-step">1</span>
          </uib-tab-heading>

          <div class="form-group mt-20">
            <label for="name" class="col-sm-3 control-label">Name <span class="text-danger" style="font-size: 15px;">*</span></label>
            <div class="col-sm-9">
              <input type="text" name="name" class="form-control" id="name" placeholder="Geofence Name..." ng-model="geofence.name" required>
              <div ng-messages="addForm.name.$error" ng-show="!addForm.name.$pristine" role="alert" class="help-block">
                <div ng-messages-include="views/pages/messages_tmpl.html"></div>
              </div>
            </div>
          </div>

          <div class="form-group mt-20">
            <label class="col-sm-3 control-label">Place</label>
            <div class="col-sm-9">

              <input type="text"
                     name="place"
                     id="placeSelect"
                     ng-model="selectedPlace"
                     typeahead-on-select="placeSelect($item)"
                     placeholder="Select a Place"
                     uib-typeahead="place as place.name for place in getPlaces($viewValue)"
                     typeahead-loading="loadingPlaces"
                     typeahead-no-results="noPlaces"
                     class="form-control"
                     typeahead-show-hint="true"
                     typeahead-min-length="0"
                     typeahead-editable="false"
                     style="margin-bottom: 5px"
              >
              <span ng-show="loadingPlaces"><i class="fa fa-circle-o-notch fa-spin text-primary"></i></span>
              <div ng-show="noPlaces"><i class="fa fa-times"></i> Could not find any places :(</div>

            </div>
          </div>

          <div class="form-group" ng-if="departmentRequired">
            <label class="col-sm-3 control-label">Department</label>
            <div class="col-sm-9">

              <input type="text"
                     name="department"
                     id="departmentSelect"
                     ng-model="selectedDepartment"
                     typeahead-on-select="departmentSelect($item)"
                     placeholder="Select a Department"
                     uib-typeahead="department as department.name for department in getDepartments($viewValue)"
                     typeahead-loading="loadingDepartments"
                     typeahead-no-results="noDepartments"
                     class="form-control"
                     typeahead-show-hint="true"
                     typeahead-min-length="0"
                     typeahead-editable="false"
                     style="margin-bottom: 5px">
              <span ng-show="loadingDepartments"><i class="fa fa-circle-o-notch fa-spin text-primary"></i></span>
              <div ng-show="noDepartments"><i class="fa fa-times"></i> Could not find any departments :(</div>

            </div>
          </div>

          <!--<div class="form-group">
            <label for="street" class="col-sm-3 control-label">Street</label>
            <div class="col-sm-9">
              <input type="text" name="street" class="form-control" id="street" placeholder="E.g Victoria Blvrd 50" ng-model="geofence.street" ng-blur="geoCodeAddress()">
            </div>
          </div>

          <div class="form-group">
            <label for="city" class="col-sm-3 control-label">City</label>
            <div class="col-sm-6">
              <input type="text" name="city" class="form-control" id="city" placeholder="E.g San Francisco" ng-model="geofence.city" ng-blur="geoCodeAddress()">
            </div>
            <label for="zip" class="col-sm-1 control-label">Zip</label>
            <div class="col-sm-2">
              <input type="text" name="zip" class="form-control" id="zip" placeholder="E.g 94104" ng-model="geofence.zip" ng-blur="geoCodeAddress()">
            </div>
          </div>

          <div class="form-group">
            <label for="country" class="col-sm-3 control-label">Country</label>
            <div class="col-sm-9">
              <input type="text" name="country" class="form-control" id="country" placeholder="E.g USA" ng-model="geofence.country" ng-blur="geoCodeAddress()">
            </div>
          </div>-->

          <div class="form-group">
            <label for="address" class="col-sm-3 control-label">Address</label>
            <div class="col-sm-9">
              <input type="text" name="address" class="form-control" id="address" placeholder="E.g Victoria Blvrd 50, San Francisco" ng-model="geofence.address" ng-blur="geoCodeAddress()">
            </div>
          </div>

          <div class="form-group" ng-if="geocodeResult">
            <label class="col-sm-3 control-label">Geocoded as</label>
            <div class="col-sm-9">
              <pre class="m-0 text-sm">{{geocodeResult}}</pre>
            </div>
          </div>

          <div class="form-group">
            <label for="lat" class="col-sm-3 control-label">Latitude <span class="text-danger" style="font-size: 15px;">*</span></label>
            <div class="col-sm-9">
              <input type="number" name="lat" class="form-control" id="lat" placeholder="Geofence Latitude..." ng-model="geofence.area.lat" required>
              <div ng-messages="addForm.lat.$error" ng-show="!addForm.lat.$pristine" role="alert" class="help-block">
                <div ng-messages-include="views/pages/messages_tmpl.html"></div>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label for="lng" class="col-sm-3 control-label">Longitude <span class="text-danger" style="font-size: 15px;">*</span></label>
            <div class="col-sm-9">
              <input type="number" name="lng" class="form-control" id="lng" placeholder="Geofence Longitude..." ng-model="geofence.area.lng" required>
              <div ng-messages="addForm.lng.$error" ng-show="!addForm.lng.$pristine" role="alert" class="help-block">
                <div ng-messages-include="views/pages/messages_tmpl.html"></div>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label for="radius" class="col-sm-3 control-label">Radius <span class="text-danger" style="font-size: 15px;">*</span></label>
            <div class="col-sm-9">
              <input type="number" name="radius" class="form-control" id="radius" placeholder="Geofence Radius..." ng-model="geofence.radius" min="0" required>
              <div ng-messages="addForm.radius.$error" ng-show="!addForm.radius.$pristine" role="alert" class="help-block">
                <div ng-messages-include="views/pages/messages_tmpl.html"></div>
              </div>
            </div>
          </div>

          <!--<div class="form-group">
            <label for="url" class="col-sm-3 control-label">Floorplan URL</label>
            <div class="col-sm-9">
              <input type="url" name="url" class="form-control" id="url" placeholder="Floorplan URL..." ng-model="geofence.floorplan_image_url">
            </div>
          </div>-->

        </uib-tab>

        <uib-tab index="1" disable="addInputForm.$invalid" select="loadMap()">

          <uib-tab-heading>
            Map
            <span class="badge badge-default pull-right wizard-step">2</span>
          </uib-tab-heading>

          <leaflet center="location" markers="markers" defaults="defaults" layers="layers" paths="paths" height="480px"></leaflet>

        </uib-tab>


      </uib-tabset>

    </form>



  </div>

  <div class="modal-footer">

    <!-- ###### 1 STEP ######-->
    <button class="btn btn-default pull-left" ng-click="active = 0" ng-show="active === 1"><i class="fa fa-angle-left"></i> Previous</button>
    <button class="btn btn-default" ng-click="makeActive(1)" ng-class="{'pull-left': active === 0}" ng-hide="active !== 0">Next <i class="fa fa-angle-right ml-5"></i></button><!-- /1 STEP -->

    <button class="btn btn-success b-0" ng-click="ok()" ng-show="active === 1">Submit</button>
    <button class="btn btn-lightred btn-ef btn-ef-4 btn-ef-4c" ng-click="cancel()"><i class="fa fa-arrow-left"></i> Cancel</button>

  </div></script> <script type="text/ng-template" id="geofenceViewModal.html"><div class="modal-header">
    <h3 class="modal-title custom-font"><i class="fa fa-circle-o mr-5"></i> Geofence Details | {{geofence.name}}</h3>
  </div>
  <div class="modal-body">


    <!-- row -->
    <div class="row">

      <!-- col -->
      <div class="col-sm-9">
        <ul class="list-unstyled m-20">
          <li><strong>ID:</strong> {{geofence.id}}</li>
          <li><strong>Geofence Name:</strong> {{geofence.name}}</li>
          <li><strong>Geofence Address:</strong>  {{geofence.address}}</li>
          <li><strong>Geofence Latitude:</strong>  {{geofence.area.lat}}</li>
          <li><strong>Geofence Longitude:</strong>  {{geofence.area.lng}}</li>
        </ul>
      </div>
      <!-- /col -->

    </div>
    <!-- /row -->


  </div>
  <div class="modal-footer">
    <button class="btn btn-lightred btn-ef btn-ef-4 btn-ef-4c" ng-click="cancel()"><i class="fa fa-arrow-left"></i> Close</button>
  </div></script>